(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{"8hLB":function(e,a,n){"use strict";var t=n("q1tI"),s=n.n(t),c=(n("Wbzz"),n("Bl7J"));a.a=function(e){return s.a.createElement(c.a,Object.assign({},e,{icon:"post"}))}},PTdH:function(e,a,n){"use strict";n.r(a),n.d(a,"_frontmatter",(function(){return o})),n.d(a,"default",(function(){return i}));var t=n("zLVn"),s=(n("q1tI"),n("7ljp")),c=n("8hLB"),o={},b={_frontmatter:o},p=c.a;function i(e){var a=e.components,n=Object(t.a)(e,["components"]);return Object(s.b)(p,Object.assign({},b,n,{components:a,mdxType:"MDXLayout"}),Object(s.b)("p",null,"Kami level power? Take my ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"root")," and show me the ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"#install"}),"code"),"..."),Object(s.b)("h1",null,"Nix is More Powerful Pkg Manger!"),Object(s.b)("p",null,"In pkg managing universe, if Conda is ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"./2018-11-18-conda-everything"}),"miniverse"),", Nix would be, let's take one step further, perhaps the real universe, or the last step before entering hybrid simulation world like docker etc. In package management and dev env setup, Nix is already system-level (God/Kami) isolation for *nix system! Though it doesn't isolate process and memory like docker does, which is still in my boundary of package manager. Setting up reproducible, reliable and efficient dev environment is what it can do best. Conda and others cannot do that because many pkg manager's dependencies are runtime and sensitive to envs and paths."),Object(s.b)("figure",{className:"gatsby-resp-image-figure",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",width:"40%",textAlign:"center",minWidth:"7rem",backgroundColor:"rgb(255, 255, 255)",border:"1px solid rgb(222, 226, 230)",maxWidth:"600px"}},"\n    ",Object(s.b)("span",Object.assign({parentName:"figure"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"600px"}}),"\n      ",Object(s.b)("a",Object.assign({parentName:"span"},{className:"gatsby-resp-image-link",href:"/static/bd222befdb546cb5d4ade6416351f61d/21b4d/god-goku.png",style:{display:"block"},target:"_blank",rel:"noopener"}),"\n    ",Object(s.b)("span",Object.assign({parentName:"a"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"92.66666666666667%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAEqUlEQVQ4y31UeVAUVBh/u8siR7AcEgIBiWALBYpyFKlcgRCHgBjKDuxAIJHcCHEop8ipsOAu7HIsrCwErnIqLRCgoClMHGIMTTlZTVJGMx1/VCz7vti3w1iJfv981+/7zfvee9+H0P9EramTaPq5i1SiM/KYKsVVyQrbuqOXimiqSmBEDDoUcgw9Vyi7rJDm6prSKa+jsK4PUhQmjdsSz7h+C1yq6lwV/vGHP9Gyj4YRWOHM4vMJVYfvKo38MkKEEjLMVNhxbpSL3Anz2wsQNHJ7aSOqTnIAKNyKiVgpp9ELRXXgJvIuKSaEhjyhQKeg9GfEEfxlMjaNi+eWYVs1P8uusjaRgM9VU7i1XEQLDtuajHb6LNGvCTrVEPtklGO75HfD6npAIgnWH53GoQOjWLu6YdWu55OVhcFhHQX2aC2fsiWZxmE/RK/ikeTL3NadqEYgC7g6CJYiyTqtqQNr9Y+BXueAnFHDB4veEVwobA9UYCXfPiYPN91Tjxwd9yvJEo1oCEgLF0gSJaW7W0hugJm4B7/R1oW1NjTlUhNmSm5gh+sT61oNIjAorOhSQGWpIZSY4TFS1t3GUxKecdtJ9AF/Txox3vFx39txDcybO7Bj3zB+s28Eo+w8HPD5l+BxZVDuPPIZuJ/Je5zjYHlos0NeVRGy1FFBOxgaykCkrTk5XbSR6iEnNnvZ8PwFmTWnASz4bTi0Twr2zWIcMnYXB0hvQezUrNwvMwNuxrvDg+mhQkVdZ7OQdq8pizrSWKSCkk2UH/UVZ5eXOAboUUJCNDh39cvVUjKwa/cgbEtKB9f2K9ijrRv7d/Xik9IpCDmbLVsMZsAjKe/HZx4kx3kHaTX+LdPYfhsVCPXc97cxh49tRFchTtiAP+WmgnezAHu0imB/RQV25vBwfrADXvJFMJF+8A8zr9z3ETrFuFaeECGpyS5HdYFMQpgXbB9zx8MArjmpr7udTsN2pWU4sbkGYHkQVzWWQpKQj3OL0nE7+3WYfk97/ZsYXXmy9z5Q8xLCXp+P1jsyguD7G3WA0k/40hWEJ1Oine+wHWDMiSY772AoS7M3xh+wfYFTU4AnxWV4RnoZ7vcJ8GyY/tpKrD7cO6YDpma7h5Cpz6S5peM8h+X024y45OHT3q3CRUf8k2BqDx0mnOggdaHjNr+d+IG4AH83XA9PZiTyJWGO7IsTmjAeqLPaakWL+PfV8eLfZZZEelqhkpgg2/yow+W7HMKxpkcdzmQaV7XtpozPh+nAQqwxvs9Lhq9GWuSTlfEwd9wYPvZWn/Bjar+qIBGxXKiKuQaAp8z9lQm/3OEmQc4RRzC2DTqljJpS+Xbb5sfd1WHCS229PcAcCpiaT1r2UD7crBty1di4ewOkZcQkPifKjdKYFkpBox01tYv9l34d4qQNk0WSfIz8yUYmfaDXhg6zIYw/H4Rrg9hNQ0DyfbrUCg8GwUgit6MiS5VnZ5kVE6+beqlTU2GLXfQIosFaNXbOTQN+iN2+thJnANIwPbJkx8N0SZ5/UBMFKH/cf2VckEvdtC9kxqHAjekBlhbxew+oZ30doQvjLL3L0dZqZK4afRlkibxtQt9y0fwDeMz2zzMsqhQAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(s.b)("img",Object.assign({parentName:"a"},{className:"gatsby-resp-image-image",alt:"Want to be God-Level Goku?",title:"Want to be God-Level Goku?",src:"/static/bd222befdb546cb5d4ade6416351f61d/0a47e/god-goku.png",srcSet:["/static/bd222befdb546cb5d4ade6416351f61d/8a4e8/god-goku.png 150w","/static/bd222befdb546cb5d4ade6416351f61d/5a46d/god-goku.png 300w","/static/bd222befdb546cb5d4ade6416351f61d/0a47e/god-goku.png 600w","/static/bd222befdb546cb5d4ade6416351f61d/1cfc2/god-goku.png 900w","/static/bd222befdb546cb5d4ade6416351f61d/c1b63/god-goku.png 1200w","/static/bd222befdb546cb5d4ade6416351f61d/21b4d/god-goku.png 1280w"],sizes:"(max-width: 600px) 100vw, 600px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n  "),"\n    "),"\n    ",Object(s.b)("figcaption",Object.assign({parentName:"figure"},{className:"gatsby-resp-image-figcaption"}),"Want to be God-Level Goku?"),"\n  "),Object(s.b)("p",null,"Note the price to pay: root permission, but you can do ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/nix-community/nix-user-chroot#user-content-installation"}),"without permission")," if namespace supported or rebuild everything from scratch if you set store in different location than ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"/nix/store"),". For linux, you have to use NixOS to enable the full power manipulating hardware and services."),Object(s.b)("h1",null,"Features Summary"),Object(s.b)("h2",null,"Immutable Dependencies"),Object(s.b)("p",null,"Means it freezes the deps during build, and it hardcodes the tool-chain (e.g. GCC) to ignore any global system wide variable (/usr/include) and version of lib. Therefore, it can handle many different version independently for even the same app and make your life easier. "),Object(s.b)("h2",null,"Versions"),Object(s.b)("p",null,"When you install, Nix uses Sqlite to persist your version and prepares for rolling back! It also creates symlink as in:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"bash"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token environment constant"}),"$HOME"),"/.nix-profile/"))),Object(s.b)("p",null,"Because of hardcoding, rolling back or version control is blasting fast just similar to how git hand files."),Object(s.b)("h2",null,"Easy Going as Other Managers"),Object(s.b)("p",null,"If you are familar with other manager tool, interacting with nix user environment is similar, e.g.:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"text"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-text"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-text"}),"Install -> nix-env -i pkgname\nUninstall -> nix-env -e pkgname\nList -> nix-env -q"))),Object(s.b)("h2",null,"Easy Share"),Object(s.b)("p",null,"You can create your own environment ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),".nix")," and share it easily to your colleagues. You can also build it to docker or virtual hard drive image!"),Object(s.b)("h2",null,"Nix Expression & Language"),Object(s.b)("p",null,"It adapts functional programming so everything is an expression/lambda/function and variables are immutable. You can use ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"nix repl")," to play with language."),Object(s.b)("p",null,"You can compile expression to create derivatives which describe how to build a package. ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),".nix")," is like ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),".c")," in C; while ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),".drv")," is like ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),".o"),". Many people are scared by it?"),Object(s.b)("h2",null,"Build Your Own Pkgs"),Object(s.b)("p",null,"It's all about writing a ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),".nix")," ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://nixos.org/guides/nix-pills/generic-builders.html#idm140737320276672"}),"expression"),". Find a nice ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/NixOS/nixpkgs/blob/master/pkgs/tools/misc/fzf/default.nix"}),"example")," in ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/NixOS/nixpkgs/tree/master/pkgs"}),"pkgs")," and copy/paste!"),Object(s.b)("p",null,"If you want to know the configs available in home-manager, just look into ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/nix-community/home-manager/blob/master/modules/programs/neovim.nix"}),"code"),"."),Object(s.b)("div",{id:"install"}),Object(s.b)("h1",null,"Install Nix"),Object(s.b)("p",null,"It's very easy to follow ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/daizeng1984/dotfiles/blob/master/installNix.sh"}),"here")," if you have root. Otherwise, you either need namespace and do:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"bash"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"wget")," https://github.com/nix-community/nix-user-chroot/releases/download/1.0.3/nix-user-chroot-bin-1.0.3-x86_64-unknown-linux-musl -O nix-user-chroot\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"chmod")," +x nix-user-chroot\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"mkdir")," -m 0755 ~/.nix\n./nix-user-chroot ~/.nix ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"bash")," -c ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"curl -L https://nixos.org/nix/install | bash"')))),Object(s.b)("p",null,"After you can run ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"nix-user-chroot ~/.nix bash")," to start bash where ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"/nix")," is mounted with namespace. You might also want to put ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"nix-user-chroot")," to your ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"$PATH"),". "),Object(s.b)("p",null,"You can play with ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"nix-env -i")," to install any packages. "),Object(s.b)("h1",null,"Install Home-Manager"),Object(s.b)("p",null,"You can define your nix environment and quickly switch it."),Object(s.b)("div",{className:"gatsby-highlight","data-language":"bash"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# install home-manager"),"\nnix-channel --add https://github.com/nix-community/home-manager/archive/master.tar.gz home-manager\nnix-channel --update\nnix-shell ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"'<home-manager>'")," -A ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"install")))),Object(s.b)("p",null,"It's must-have if you like Nix to manage your dotfiles and home folder etc."),Object(s.b)("h1",null,"Setup Pkgs At Home"),Object(s.b)("p",null,'Here\'s I did some env var trick to switch different profiles, like "base", etc. to point to a ',Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"cli.nix")," file that contains the actual code of pkgs:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"nix"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-nix"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-nix"}),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," config",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),".")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":"),"\n\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"let")," profiles ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# Base includes shell and utility related install"),"\n  base ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token url"}),"./profiles/cli.nix"),"\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\nenvProfile ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"builtins"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"getEnv")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"MY_NIX_PROFILE"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# I'm sure here can do better, now tolerate nix baby language 😂"),"\nprofile ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"if")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"envProfile",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),'"')," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"==")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'""'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"then")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"base"')," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"else")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"envProfile",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),'"')," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"in"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n  nixpkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"config",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"allowUnfree ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token boolean"}),"true"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# Let Home Manager install and manage itself."),"\n  programs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"home",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-"),"manager",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"enable ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token boolean"}),"true"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  imports ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"if")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"builtins"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"hasAttr")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"profile",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),'"')," profiles",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"then")," profiles",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"profile",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),'"')," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"else")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"[")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"profile",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),'"')," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"#"),"\n  home",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"username ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Zeng Dai"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n  home",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"homeDirectory ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"builtins"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"getEnv")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"HOME"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n  \n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# Starting ver"),"\n  home",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"stateVersion ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"20.09"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("p",null,"Then in ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"cli.nix"),' for "base" profile, it mainly install the CLI tools (my precious pick):'),Object(s.b)("div",{className:"gatsby-highlight","data-language":"nix"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-nix"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-nix"}),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," config",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," lib",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),".")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"let"),"\n  comma ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"import")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"(")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"fetchFromGitHub ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n      owner ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Shopify"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      repo ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"comma"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      rev ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"4a62ec17e20ce0e738a8e5126b4298a73903b468"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      sha256 ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"0n5a3rnv9qnnsrl76kpi6dmaxmwj1mpdd2g0b4n1wfimqfaz6gi1"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"in"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n  home",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"packages ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"with")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"\n    fzf\n    vim\n    direnv ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# how to setup nix-shell? https://nixos.org/guides/declarative-and-reproducible-developer-environments.html#declarative-reproducible-envs"),"\n    httpie\n    tmux\n    ag\n    fasd\n    ripgrep\n    tree\n    broot\n    ranger\n    trash",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-"),"cli\n    rsync\n    fd\n    exa\n    comma\n    bat\n    htop\n    navi\n    tldr\n    neofetch\n    tokei\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")))),Object(s.b)("h1",null,"Customization Home"),Object(s.b)("p",null,"How about the dotfiles? The Nix language provides tons of flexibility to do whatever you need to do. Mostly you can check the options of customization, for ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/nix-community/home-manager/blob/master/modules/programs/neovim.nix"}),"example"),"."),Object(s.b)("p",null,"Basically, it allows you to put all dotfiles into the nix scripts."),Object(s.b)("h1",null,"Desktop App"),Object(s.b)("p",null,"For Linux, you simply install it in Nix. To make it appear in your e.g. Gnome launchpad, you need to create ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),".profile")," like:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"bash"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-bash"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# Makesure gnome know these path"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token builtin class-name"}),"export")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token assign-left variable"}),"NIX_HOME_PATH"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token environment constant"}),"$HOME"),"/.nix-profile\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"if")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"[")," -e ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token variable"}),"$NIX_HOME_PATH"),"/etc/profile.d/nix.sh ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"then")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token builtin class-name"}),".")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token variable"}),"$NIX_HOME_PATH"),"/etc/profile.d/nix.sh",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"fi")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# added by Nix installer"),"\n\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token builtin class-name"}),"export")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token assign-left variable"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token environment constant"}),"XDG_DATA_DIRS")),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token environment constant"}),"$HOME"),"/.nix-profile/share:",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token environment constant"}),"$HOME"),"/.share:",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object.assign({parentName:"span"},{className:"token variable"}),"${",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token environment constant"}),"XDG_DATA_DIRS"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token operator"}),":-"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token operator"}),"/"),"usr",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token operator"}),"/"),"local",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token operator"}),"/"),"share",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token operator"}),"/"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token operator"}),":"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token operator"}),"/"),"usr",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token operator"}),"/"),"share",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token operator"}),"/"),"}"),'"')))),Object(s.b)("p",null,"Logout and in to restart the desktop."),Object(s.b)("p",null,"For some application, it requires GL e.g. ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"alacritty"),". You need to install ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/guibou/nixGL"}),"nixGL"),":"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"nix"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-nix"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-nix"}),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"let"),"\n  nixGL ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"import")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"(")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"fetchFromGitHub ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n      owner ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"guibou"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      repo ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"nixGL"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      rev ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"fad15ba09de65fc58052df84b9f68fbc088e5e7c"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      sha256 ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"1wc5gfj5ymgm4gxx5pz4lkqp5vxqdk2njlbnrc1kmailgzj6f75h"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"in"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n  home",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"packages ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"with")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"\n    nixGL",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"nixGLDefault\n    ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("p",null,"Then run your GL application as ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"nixGL alacritty"),"."),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},"HOWEVER"),", desktop support for non NixOS is limited. Basically you need many knowledge regarding your X window environment and build many things from scratch, while only NixOS has native support. If you are interested how I achieved that under Centos, please check out ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/daizeng1984/dotfiles/tree/master/nix/nixpkgs"}),"my nix files")," and ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/daizeng1984/dotfiles/blob/master/linux/.profile"}),".profile"),". Each X window desktop have its own implementation that not necessarily follows statndard. You can enable ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"home-manager"),"'s xserver support but without NixOS, you have to know and hookup everything on your own. On Mac most app e.g. firefox won't be available, you have to write some ",Object(s.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/cmacrae/config/blob/b33ccb041861b56c97e1744b0fd8c606e343164c/overlays/firefox/default.nix"}),"wrapper")," to download/unpack dmg to cheat. At least you don't need to stick to brew cask."),Object(s.b)("h1",null,"Systemd Service"),Object(s.b)("p",null,"If you want to start daemon service in Linux, for example, a cloud folder, you can use home-manager to setup these service like this:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"nix"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-nix"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-nix"}),"  systemd",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"user ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    services",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"dropbox_rclone ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"let"),"\n        mountdir",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"="),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"config",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"."),"home",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"."),"homeDirectory",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),'/cloud/dropbox"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"in"),"\n      ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n      Unit ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n        Description ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"dropbox rclone mount"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      Install",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"WantedBy ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"[")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"multi-user.target"')," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      Service ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n          ExecStartPre ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"pkgs",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"."),"coreutils",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),"/bin/mkdir -p ",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"mountdir",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),'"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n          ExecStart ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),"''\n              ",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"pkgs",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"."),"rclone",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),"/bin/rclone mount dropbox: ",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"mountdir",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),"\n          ''"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n          ExecStop ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"pkgs",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"."),"fuse",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),"/bin/fusermount -uz ",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token antiquotation variable"}),"$"),Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"{"),"mountdir",Object(s.b)("span",Object.assign({parentName:"span"},{className:"token punctuation"}),"}")),'"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n          Type ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"notify"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n          Restart ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"always"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n          RestartSec ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"10s"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";")))),Object(s.b)("h1",null,"Development"),Object(s.b)("p",null,"This is the area that Nix really shines. With Nix you basically could dump all other package managers. For example, you could nail down the particular version of main source ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"nixpkgs")," like:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"nix"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-nix"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-nix"}),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," pkgs ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"?")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"import")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"fetchTarball")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"https://github.com/NixOS/nixpkgs/archive/3590f02e7d5760e52072c1a729ee2250b5560746.tar.gz"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")))),Object(s.b)("p",null,"to pin a specific python package:"),Object(s.b)("div",{className:"gatsby-highlight","data-language":"nix"},Object(s.b)("pre",Object.assign({parentName:"div"},{className:"language-nix"}),Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-nix"}),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{")," pkgs ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"?")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token function"}),"import"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"<"),"nixpkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),">"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":"),"\n\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"let"),"\n  myranger ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"python3",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"buildPythonPackage rec ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n    pname ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"ranger-fm"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n    version ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"1.9.0"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n\n    src ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"python3",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"fetchPypi ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"inherit")," pname version",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),'#format = "wheel"; # tar.gz is default'),"\n      ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),'# python = "cp38";'),"\n      ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),'# abi = "cp38";'),"\n      ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),'# platform = "manylinux1_x86_64";'),"\n      sha256 ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"1ay8lhgkqzmvavinbmzdgh8pgkddpx72pygi4d9ac01jbbggibkg"'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n\n    ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token comment"}),'#format = "wheel"; # tar.gz is default'),"\n\n    meta ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n      homepage ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"..."'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n      description ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token string"}),'"..."'),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n  pythonEnv ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"python3",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"withPackages ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"ps",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"\n    myranger\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"in")," pkgs",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"mkShell ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"{"),"\n  buildInputs ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"["),"\n    pythonEnv\n  ",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"]"),Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(s.b)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("p",null,"For general packages, you can always take a look at the ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"default.nix")," for the package you want to pin."),Object(s.b)("p",null,"Plus the power of ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),"direnv")," and ",Object(s.b)("code",Object.assign({parentName:"p"},{className:"language-text"}),".envrc")," you can do auto shell env change when enter the folder!"),Object(s.b)("h1",null,"NixOS"),Object(s.b)("p",null,"Under NixOS, this idea is pushed further. Everything in OS is configurable in Nix language. I like the idea of using language to define your machine in a uniform way, but unfortunately so far only NixOS is supported. It means not transferrable to other OS. Probably I'll try it out in the future post."))}i.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-posts-2020-10-24-nix-power-mdx-7657249c6e444a247573.js.map